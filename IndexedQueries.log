Query 1:
"Sort  (cost=4502.79..4559.51 rows=22688 width=88) (actual time=379.889..383.429 rows=22688 loops=1)"
"  Sort Key: f.flight_number"
"  Sort Method: quicksort  Memory: 3191kB"
"  ->  Hash Left Join  (cost=1346.11..2861.35 rows=22688 width=88) (actual time=15.057..355.814 rows=22688 loops=1)"
"        Hash Cond: ((arr_airport.airport_id = arr_weather.airport_id) AND ((SubPlan 2) = arr_weather.update_time))"
"        ->  Hash Join  (cost=1346.09..2549.36 rows=22688 width=84) (actual time=15.017..230.638 rows=22688 loops=1)"
"              Hash Cond: (f.arrival_airport_id = arr_airport.airport_id)"
"              ->  Hash Left Join  (cost=1249.66..2393.29 rows=22688 width=67) (actual time=13.607..210.251 rows=22688 loops=1)"
"                    Hash Cond: ((dep_airport.airport_id = dep_weather.airport_id) AND ((SubPlan 1) = dep_weather.update_time))"
"                    ->  Hash Join  (cost=1249.65..2081.31 rows=22688 width=63) (actual time=13.510..76.959 rows=22688 loops=1)"
"                          Hash Cond: (f.arrival_gate_id = arr_gate.gate_id)"
"                          ->  Hash Join  (cost=673.04..1445.13 rows=22688 width=58) (actual time=7.065..52.182 rows=22688 loops=1)"
"                                Hash Cond: (f.departure_airport_id = dep_airport.airport_id)"
"                                ->  Hash Join  (cost=576.61..1289.06 rows=22688 width=41) (actual time=5.919..35.633 rows=22688 loops=1)"
"                                      Hash Cond: (f.departure_gate_id = dep_gate.gate_id)"
"                                      ->  Seq Scan on flight f  (cost=0.00..652.88 rows=22688 width=36) (actual time=0.037..7.100 rows=22688 loops=1)"
"                                      ->  Hash  (cost=345.16..345.16 rows=18516 width=9) (actual time=5.714..5.717 rows=18516 loops=1)"
"                                            Buckets: 32768  Batches: 1  Memory Usage: 1014kB"
"                                            ->  Seq Scan on gate dep_gate  (cost=0.00..345.16 rows=18516 width=9) (actual time=0.017..2.647 rows=18516 loops=1)"
"                                ->  Hash  (cost=61.19..61.19 rows=2819 width=21) (actual time=1.061..1.062 rows=2819 loops=1)"
"                                      Buckets: 4096  Batches: 1  Memory Usage: 183kB"
"                                      ->  Seq Scan on airport dep_airport  (cost=0.00..61.19 rows=2819 width=21) (actual time=0.024..0.478 rows=2819 loops=1)"
"                          ->  Hash  (cost=345.16..345.16 rows=18516 width=9) (actual time=6.260..6.261 rows=18516 loops=1)"
"                                Buckets: 32768  Batches: 1  Memory Usage: 1014kB"
"                                ->  Seq Scan on gate arr_gate  (cost=0.00..345.16 rows=18516 width=9) (actual time=0.049..2.968 rows=18516 loops=1)"
"                    ->  Hash  (cost=0.00..0.00 rows=1 width=12) (actual time=0.019..0.020 rows=0 loops=1)"
"                          Buckets: 1024  Batches: 1  Memory Usage: 8kB"
"                          ->  Seq Scan on weather dep_weather  (cost=0.00..0.00 rows=1 width=12) (actual time=0.019..0.019 rows=0 loops=1)"
"                    SubPlan 1"
"                      ->  Aggregate  (cost=0.00..0.01 rows=1 width=4) (actual time=0.005..0.005 rows=1 loops=22688)"
"                            ->  Seq Scan on weather  (cost=0.00..0.00 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=22688)"
"                                  Filter: (airport_id = dep_airport.airport_id)"
"              ->  Hash  (cost=61.19..61.19 rows=2819 width=21) (actual time=1.339..1.340 rows=2819 loops=1)"
"                    Buckets: 4096  Batches: 1  Memory Usage: 183kB"
"                    ->  Seq Scan on airport arr_airport  (cost=0.00..61.19 rows=2819 width=21) (actual time=0.062..0.642 rows=2819 loops=1)"
"        ->  Hash  (cost=0.00..0.00 rows=1 width=12) (actual time=0.006..0.006 rows=0 loops=1)"
"              Buckets: 1024  Batches: 1  Memory Usage: 8kB"
"              ->  Seq Scan on weather arr_weather  (cost=0.00..0.00 rows=1 width=12) (actual time=0.005..0.005 rows=0 loops=1)"
"        SubPlan 2"
"          ->  Aggregate  (cost=0.00..0.01 rows=1 width=4) (actual time=0.004..0.004 rows=1 loops=22688)"
"                ->  Seq Scan on weather weather_1  (cost=0.00..0.00 rows=1 width=4) (actual time=0.000..0.000 rows=0 loops=22688)"
"                      Filter: (airport_id = arr_airport.airport_id)"
"Planning Time: 4.491 ms"
"Execution Time: 386.243 ms"


Query 2:
"Sort  (cost=2009.74..2016.79 rows=2819 width=53) (actual time=38.492..38.743 rows=2819 loops=1)"
"  Sort Key: a.airport_id"
"  Sort Method: quicksort  Memory: 244kB"
"  ->  HashAggregate  (cost=1812.96..1848.20 rows=2819 width=53) (actual time=35.356..37.025 rows=2819 loops=1)"
"        Group Key: a.airport_id"
"        Batches: 1  Memory Usage: 1393kB"
"        ->  Hash Right Join  (cost=862.75..1784.78 rows=5636 width=29) (actual time=13.104..31.826 rows=5636 loops=1)"
"              Hash Cond: (""*SELECT* 1"".airport_id = a.airport_id)"
"              ->  Append  (cost=766.32..1673.54 rows=5636 width=12) (actual time=11.728..27.886 rows=5636 loops=1)"
"                    ->  Subquery Scan on ""*SELECT* 1""  (cost=766.32..822.70 rows=2819 width=12) (actual time=11.727..12.652 rows=2819 loops=1)"
"                          ->  HashAggregate  (cost=766.32..794.51 rows=2819 width=12) (actual time=11.725..12.346 rows=2819 loops=1)"
"                                Group Key: flight.departure_airport_id"
"                                Batches: 1  Memory Usage: 369kB"
"                                ->  Seq Scan on flight  (cost=0.00..652.88 rows=22688 width=4) (actual time=0.031..3.007 rows=22688 loops=1)"
"                    ->  Subquery Scan on ""*SELECT* 2""  (cost=766.32..822.66 rows=2817 width=12) (actual time=13.600..14.788 rows=2817 loops=1)"
"                          ->  HashAggregate  (cost=766.32..794.49 rows=2817 width=12) (actual time=13.597..14.425 rows=2817 loops=1)"
"                                Group Key: flight_1.arrival_airport_id"
"                                Batches: 1  Memory Usage: 369kB"
"                                ->  Seq Scan on flight flight_1  (cost=0.00..652.88 rows=22688 width=4) (actual time=0.040..3.318 rows=22688 loops=1)"
"              ->  Hash  (cost=61.19..61.19 rows=2819 width=21) (actual time=1.327..1.328 rows=2819 loops=1)"
"                    Buckets: 4096  Batches: 1  Memory Usage: 179kB"
"                    ->  Seq Scan on airport a  (cost=0.00..61.19 rows=2819 width=21) (actual time=0.051..0.495 rows=2819 loops=1)"
"Planning Time: 0.560 ms"
"Execution Time: 39.861 ms"


Query 3:
"Sort  (cost=2678.33..2716.20 rows=15147 width=36) (actual time=28.435..30.371 rows=16236 loops=1)"
"  Sort Key: f.flight_number"
"  Sort Method: quicksort  Memory: 1399kB"
"  ->  Hash Right Anti Join  (cost=936.48..1626.62 rows=15147 width=36) (actual time=17.478..22.544 rows=16236 loops=1)"
"        Hash Cond: (c.flight_number = f.flight_number)"
"        ->  Seq Scan on crew c  (cost=0.00..642.46 rows=7541 width=4) (actual time=0.041..4.045 rows=7541 loops=1)"
"              Filter: (crew_type = 'Pilot'::crew_type)"
"              Rows Removed by Filter: 15136"
"        ->  Hash  (cost=652.88..652.88 rows=22688 width=36) (actual time=9.250..9.252 rows=22688 loops=1)"
"              Buckets: 32768  Batches: 1  Memory Usage: 1763kB"
"              ->  Seq Scan on flight f  (cost=0.00..652.88 rows=22688 width=36) (actual time=0.031..3.390 rows=22688 loops=1)"
"Planning Time: 0.290 ms"
"Execution Time: 31.458 ms"


Query 4:
"Sort  (cost=2278560.71..2278560.71 rows=1 width=74) (actual time=4408.755..4408.760 rows=0 loops=1)"
"  Sort Key: f.flight_number"
"  Sort Method: quicksort  Memory: 25kB"
"  ->  Hash Join  (cost=1731.61..2278560.70 rows=1 width=74) (actual time=4408.685..4408.690 rows=0 loops=1)"
"        Hash Cond: ((f.arrival_airport_id = arr_airport.airport_id) AND (arr_weather.update_time = (SubPlan 2)))"
"        ->  Hash Join  (cost=1628.14..2267234.38 rows=250 width=65) (never executed)"
"              Hash Cond: ((f.arrival_airport_id = arr_weather.airport_id) AND (dep_weather.conditions = arr_weather.conditions))"
"              ->  Nested Loop  (cost=103.76..2265676.46 rows=276 width=57) (never executed)"
"                    Join Filter: (dep_airport.airport_id = f.departure_airport_id)"
"                    ->  Index Scan using flight_pkey on flight f  (cost=0.29..2600.58 rows=22688 width=36) (never executed)"
"                    ->  Materialize  (cost=103.47..2251505.08 rows=34 width=29) (never executed)"
"                          ->  Hash Join  (cost=103.47..2251504.91 rows=34 width=29) (never executed)"
"                                Hash Cond: ((dep_weather.airport_id = dep_airport.airport_id) AND (dep_weather.update_time = (SubPlan 1)))"
"                                ->  Seq Scan on weather dep_weather  (cost=0.00..772.35 rows=50135 width=12) (never executed)"
"                                ->  Hash  (cost=61.19..61.19 rows=2819 width=21) (never executed)"
"                                      ->  Seq Scan on airport dep_airport  (cost=0.00..61.19 rows=2819 width=21) (never executed)"
"                                      SubPlan 1"
"                                        ->  Aggregate  (cost=897.71..897.72 rows=1 width=4) (never executed)"
"                                              ->  Seq Scan on weather  (cost=0.00..897.69 rows=10 width=4) (never executed)"
"                                                    Filter: (airport_id = dep_airport.airport_id)"
"              ->  Hash  (cost=772.35..772.35 rows=50135 width=12) (never executed)"
"                    ->  Seq Scan on weather arr_weather  (cost=0.00..772.35 rows=50135 width=12) (never executed)"
"        ->  Hash  (cost=61.19..61.19 rows=2819 width=21) (actual time=4408.559..4408.560 rows=0 loops=1)"
"              Buckets: 4096  Batches: 1  Memory Usage: 32kB"
"              ->  Seq Scan on airport arr_airport  (cost=0.00..61.19 rows=2819 width=21) (actual time=0.208..8.129 rows=2819 loops=1)"
"              SubPlan 2"
"                ->  Aggregate  (cost=897.71..897.72 rows=1 width=4) (actual time=1.552..1.552 rows=1 loops=2819)"
"                      ->  Seq Scan on weather weather_1  (cost=0.00..897.69 rows=10 width=4) (actual time=1.524..1.524 rows=0 loops=2819)"
"                            Filter: (airport_id = arr_airport.airport_id)"
"Planning Time: 4.035 ms"
"Execution Time: 4409.059 ms"


Query 5:
"Update on gate g  (cost=576.61..1293.45 rows=0 width=0) (actual time=40.936..40.938 rows=0 loops=1)"
"  ->  Hash Join  (cost=576.61..1293.45 rows=2758 width=16) (actual time=6.306..13.237 rows=2758 loops=1)"
"        Hash Cond: (f.departure_gate_id = g.gate_id)"
"        ->  Seq Scan on flight f  (cost=0.00..709.60 rows=2758 width=10) (actual time=0.021..4.981 rows=2758 loops=1)"
"              Filter: (flight_status = 'Departed'::flight_status)"
"              Rows Removed by Filter: 19930"
"        ->  Hash  (cost=345.16..345.16 rows=18516 width=10) (actual time=6.124..6.125 rows=18516 loops=1)"
"              Buckets: 32768  Batches: 1  Memory Usage: 1052kB"
"              ->  Seq Scan on gate g  (cost=0.00..345.16 rows=18516 width=10) (actual time=0.017..2.921 rows=18516 loops=1)"
"Planning Time: 0.398 ms"
"Execution Time: 41.476 ms"

Query 6:
"Update on flight f  (cost=236.67..952.23 rows=0 width=0) (actual time=6.014..6.017 rows=0 loops=1)"
"  ->  Hash Join  (cost=236.67..952.23 rows=386 width=16) (actual time=6.012..6.015 rows=0 loops=1)"
"        Hash Cond: (f.aircraft_id = a.aircraft_id)"
"        ->  Seq Scan on flight f  (cost=0.00..709.60 rows=2272 width=10) (actual time=0.023..3.365 rows=2272 loops=1)"
"              Filter: (flight_status = 'Boarding'::flight_status)"
"              Rows Removed by Filter: 20416"
"        ->  Hash  (cost=194.16..194.16 rows=3401 width=10) (actual time=2.263..2.264 rows=3401 loops=1)"
"              Buckets: 4096  Batches: 1  Memory Usage: 179kB"
"              ->  Bitmap Heap Scan on aircraft a  (cost=42.65..194.16 rows=3401 width=10) (actual time=0.670..1.620 rows=3401 loops=1)"
"                    Recheck Cond: (current_status = 'Boarding'::aircraft_status)"
"                    Heap Blocks: exact=109"
"                    ->  Bitmap Index Scan on idx_aircraft_current_status  (cost=0.00..41.80 rows=3401 width=0) (actual time=0.641..0.641 rows=3401 loops=1)"
"                          Index Cond: (current_status = 'Boarding'::aircraft_status)"
"Planning Time: 4.565 ms"
"Execution Time: 6.622 ms"