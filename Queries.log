Query 1: Get all flights with gate, airport and weather information
"Sort  (cost=4493597.70..4493722.70 rows=50000 width=88) (actual time=159343.565..159354.847 rows=50444 loops=1)"
"  Sort Key: f.flight_number"
"  Sort Method: external merge  Disk: 5088kB"
"  ->  Hash Join  (cost=2244486.50..4487301.29 rows=50000 width=88) (actual time=119818.656..159251.032 rows=50444 loops=1)"
"        Hash Cond: (f.arrival_gate_id = arr_gate.gate_id)"
"        ->  Hash Join  (cost=2243764.00..4486447.52 rows=50000 width=83) (actual time=119793.902..159170.346 rows=50444 loops=1)"
"              Hash Cond: (f.departure_gate_id = dep_gate.gate_id)"
"              ->  Hash Join  (cost=2243041.50..4485593.75 rows=50000 width=78) (actual time=119785.888..159119.843 rows=50444 loops=1)"
"                    Hash Cond: (f.arrival_airport_id = arr_airport.airport_id)"
"                    ->  Hash Join  (cost=1700.00..2243564.75 rows=50000 width=57) (actual time=37878.799..77156.031 rows=50213 loops=1)"
"                          Hash Cond: (dep_airport.airport_id = f.departure_airport_id)"
"                          ->  Hash Right Join  (cost=158.00..2241279.00 rows=5000 width=29) (actual time=37815.186..77043.732 rows=5019 loops=1)"
"                                Hash Cond: ((dep_weather.airport_id = dep_airport.airport_id) AND (dep_weather.update_time = (SubPlan 1)))"
"                                ->  Seq Scan on weather dep_weather  (cost=0.00..771.00 rows=50000 width=12) (actual time=0.027..8.601 rows=50000 loops=1)"
"                                ->  Hash  (cost=83.00..83.00 rows=5000 width=21) (actual time=37807.067..37807.070 rows=5000 loops=1)"
"                                      Buckets: 8192  Batches: 1  Memory Usage: 331kB"
"                                      ->  Seq Scan on airport dep_airport  (cost=0.00..83.00 rows=5000 width=21) (actual time=0.194..17.472 rows=5000 loops=1)"
"                                      SubPlan 1"
"                                        ->  Aggregate  (cost=896.02..896.03 rows=1 width=4) (actual time=7.672..7.673 rows=1 loops=10019)"
"                                              ->  Seq Scan on weather  (cost=0.00..896.00 rows=10 width=4) (actual time=0.753..7.638 rows=10 loops=10019)"
"                                                    Filter: (airport_id = dep_airport.airport_id)"
"                                                    Rows Removed by Filter: 49990"
"                          ->  Hash  (cost=917.00..917.00 rows=50000 width=36) (actual time=63.166..63.168 rows=50000 loops=1)"
"                                Buckets: 65536  Batches: 1  Memory Usage: 3833kB"
"                                ->  Seq Scan on flight f  (cost=0.00..917.00 rows=50000 width=36) (actual time=0.769..43.009 rows=50000 loops=1)"
"                    ->  Hash  (cost=2241279.00..2241279.00 rows=5000 width=29) (actual time=81906.995..81907.002 rows=5019 loops=1)"
"                          Buckets: 8192  Batches: 1  Memory Usage: 371kB"
"                          ->  Hash Right Join  (cost=158.00..2241279.00 rows=5000 width=29) (actual time=40900.276..81887.356 rows=5019 loops=1)"
"                                Hash Cond: ((arr_weather.airport_id = arr_airport.airport_id) AND (arr_weather.update_time = (SubPlan 2)))"
"                                ->  Seq Scan on weather arr_weather  (cost=0.00..771.00 rows=50000 width=12) (actual time=0.071..9.346 rows=50000 loops=1)"
"                                ->  Hash  (cost=83.00..83.00 rows=5000 width=21) (actual time=40892.005..40892.008 rows=5000 loops=1)"
"                                      Buckets: 8192  Batches: 1  Memory Usage: 331kB"
"                                      ->  Seq Scan on airport arr_airport  (cost=0.00..83.00 rows=5000 width=21) (actual time=0.028..6.764 rows=5000 loops=1)"
"                                      SubPlan 2"
"                                        ->  Aggregate  (cost=896.02..896.03 rows=1 width=4) (actual time=8.155..8.156 rows=1 loops=10019)"
"                                              ->  Seq Scan on weather weather_1  (cost=0.00..896.00 rows=10 width=4) (actual time=0.806..8.116 rows=10 loops=10019)"
"                                                    Filter: (airport_id = arr_airport.airport_id)"
"                                                    Rows Removed by Filter: 49990"
"              ->  Hash  (cost=410.00..410.00 rows=25000 width=9) (actual time=7.893..7.894 rows=25000 loops=1)"
"                    Buckets: 32768  Batches: 1  Memory Usage: 1280kB"
"                    ->  Seq Scan on gate dep_gate  (cost=0.00..410.00 rows=25000 width=9) (actual time=0.022..3.191 rows=25000 loops=1)"
"        ->  Hash  (cost=410.00..410.00 rows=25000 width=9) (actual time=24.612..24.613 rows=25000 loops=1)"
"              Buckets: 32768  Batches: 1  Memory Usage: 1280kB"
"              ->  Seq Scan on gate arr_gate  (cost=0.00..410.00 rows=25000 width=9) (actual time=1.262..18.956 rows=25000 loops=1)"
"Planning Time: 25.804 ms"
"Execution Time: 159366.594 ms"


Query 2: Get all airports and the total number of flights for each airport
"Sort  (cost=3166.79..3179.29 rows=5000 width=53) (actual time=40.831..41.130 rows=5000 loops=1)"
"  Sort Key: a.airport_id"
"  Sort Method: quicksort  Memory: 453kB"
"  ->  HashAggregate  (cost=2797.09..2859.59 rows=5000 width=53) (actual time=38.147..39.476 rows=5000 loops=1)"
"        Group Key: a.airport_id"
"        Batches: 1  Memory Usage: 2257kB"
"        ->  Hash Right Join  (cost=1312.50..2748.42 rows=9734 width=29) (actual time=14.691..33.556 rows=9900 loops=1)"
"              Hash Cond: (""*SELECT* 1"".airport_id = a.airport_id)"
"              ->  Append  (cost=1167.00..2577.35 rows=9734 width=12) (actual time=13.761..29.639 rows=9863 loops=1)"
"                    ->  Subquery Scan on ""*SELECT* 1""  (cost=1167.00..1264.26 rows=4863 width=12) (actual time=13.760..14.886 rows=4931 loops=1)"
"                          ->  HashAggregate  (cost=1167.00..1215.63 rows=4863 width=12) (actual time=13.758..14.528 rows=4931 loops=1)"
"                                Group Key: flight.departure_airport_id"
"                                Batches: 1  Memory Usage: 721kB"
"                                ->  Seq Scan on flight  (cost=0.00..917.00 rows=50000 width=4) (actual time=0.010..3.159 rows=50000 loops=1)"
"                    ->  Subquery Scan on ""*SELECT* 2""  (cost=1167.00..1264.42 rows=4871 width=12) (actual time=12.967..14.246 rows=4932 loops=1)"
"                          ->  HashAggregate  (cost=1167.00..1215.71 rows=4871 width=12) (actual time=12.965..13.824 rows=4932 loops=1)"
"                                Group Key: flight_1.arrival_airport_id"
"                                Batches: 1  Memory Usage: 721kB"
"                                ->  Seq Scan on flight flight_1  (cost=0.00..917.00 rows=50000 width=4) (actual time=0.032..2.997 rows=50000 loops=1)"
"              ->  Hash  (cost=83.00..83.00 rows=5000 width=21) (actual time=0.889..0.889 rows=5000 loops=1)"
"                    Buckets: 8192  Batches: 1  Memory Usage: 324kB"
"                    ->  Seq Scan on airport a  (cost=0.00..83.00 rows=5000 width=21) (actual time=0.017..0.322 rows=5000 loops=1)"
"Planning Time: 4.281 ms"
"Execution Time: 42.486 ms"


Query 3: Get all flights that do not have a pilot
"Sort  (cost=5142.52..5226.09 rows=33428 width=36) (actual time=101.434..106.095 rows=35801 loops=1)"
"  Sort Key: f.flight_number"
"  Sort Method: quicksort  Memory: 3355kB"
"  ->  Hash Right Anti Join  (cost=1542.00..2630.61 rows=33428 width=36) (actual time=73.222..85.928 rows=35801 loops=1)"
"        Hash Cond: (c.flight_number = f.flight_number)"
"        ->  Seq Scan on crew c  (cost=0.00..984.00 rows=16572 width=4) (actual time=1.014..51.984 rows=16701 loops=1)"
"              Filter: (crew_type = 'Pilot'::crew_type)"
"              Rows Removed by Filter: 33299"
"        ->  Hash  (cost=917.00..917.00 rows=50000 width=36) (actual time=12.612..12.614 rows=50000 loops=1)"
"              Buckets: 65536  Batches: 1  Memory Usage: 3833kB"
"              ->  Seq Scan on flight f  (cost=0.00..917.00 rows=50000 width=36) (actual time=0.016..3.718 rows=50000 loops=1)"
"Planning Time: 8.006 ms"
"Execution Time: 108.023 ms"


Query 4: Get all flights with matching weather conditions at the departure and arrival airports
"Sort  (cost=2258468.80..2258468.81 rows=1 width=74) (actual time=151725.224..151725.997 rows=4553 loops=1)"
"  Sort Key: f.flight_number"
"  Sort Method: quicksort  Memory: 650kB"
"  ->  Hash Join  (cost=3379.00..2258468.79 rows=1 width=74) (actual time=75386.043..151706.086 rows=4553 loops=1)"
"        Hash Cond: ((f.arrival_airport_id = arr_airport.airport_id) AND (arr_weather.update_time = (SubPlan 2)))"
"        ->  Hash Join  (cost=3221.00..2244375.82 rows=311 width=65) (actual time=39413.311..79499.880 rows=45668 loops=1)"
"              Hash Cond: ((f.arrival_airport_id = arr_weather.airport_id) AND (dep_weather.conditions = arr_weather.conditions))"
"              ->  Hash Join  (cost=1700.00..2242826.06 rows=342 width=57) (actual time=39387.132..79395.978 rows=50213 loops=1)"
"                    Hash Cond: (dep_airport.airport_id = f.departure_airport_id)"
"                    ->  Hash Join  (cost=158.00..2241279.00 rows=34 width=29) (actual time=39364.135..79319.315 rows=5019 loops=1)"
"                          Hash Cond: ((dep_weather.airport_id = dep_airport.airport_id) AND (dep_weather.update_time = (SubPlan 1)))"
"                          ->  Seq Scan on weather dep_weather  (cost=0.00..771.00 rows=50000 width=12) (actual time=0.036..8.923 rows=50000 loops=1)"
"                          ->  Hash  (cost=83.00..83.00 rows=5000 width=21) (actual time=39356.320..39356.322 rows=5000 loops=1)"
"                                Buckets: 8192  Batches: 1  Memory Usage: 331kB"
"                                ->  Seq Scan on airport dep_airport  (cost=0.00..83.00 rows=5000 width=21) (actual time=0.018..5.636 rows=5000 loops=1)"
"                                SubPlan 1"
"                                  ->  Aggregate  (cost=896.02..896.03 rows=1 width=4) (actual time=7.902..7.902 rows=1 loops=10019)"
"                                        ->  Seq Scan on weather  (cost=0.00..896.00 rows=10 width=4) (actual time=0.773..7.869 rows=10 loops=10019)"
"                                              Filter: (airport_id = dep_airport.airport_id)"
"                                              Rows Removed by Filter: 49990"
"                    ->  Hash  (cost=917.00..917.00 rows=50000 width=36) (actual time=22.608..22.615 rows=50000 loops=1)"
"                          Buckets: 65536  Batches: 1  Memory Usage: 3833kB"
"                          ->  Seq Scan on flight f  (cost=0.00..917.00 rows=50000 width=36) (actual time=0.041..6.294 rows=50000 loops=1)"
"              ->  Hash  (cost=771.00..771.00 rows=50000 width=12) (actual time=25.776..25.777 rows=50000 loops=1)"
"                    Buckets: 65536  Batches: 1  Memory Usage: 2661kB"
"                    ->  Seq Scan on weather arr_weather  (cost=0.00..771.00 rows=50000 width=12) (actual time=0.032..10.713 rows=50000 loops=1)"
"        ->  Hash  (cost=83.00..83.00 rows=5000 width=21) (actual time=35964.815..35964.817 rows=5000 loops=1)"
"              Buckets: 8192  Batches: 1  Memory Usage: 331kB"
"              ->  Seq Scan on airport arr_airport  (cost=0.00..83.00 rows=5000 width=21) (actual time=0.026..5.827 rows=5000 loops=1)"
"              SubPlan 2"
"                ->  Aggregate  (cost=896.02..896.03 rows=1 width=4) (actual time=7.544..7.544 rows=1 loops=9553)"
"                      ->  Seq Scan on weather weather_1  (cost=0.00..896.00 rows=10 width=4) (actual time=0.736..7.512 rows=10 loops=9553)"
"                            Filter: (airport_id = arr_airport.airport_id)"
"                            Rows Removed by Filter: 49990"
"Planning Time: 3.395 ms"
"Execution Time: 151728.125 ms"


Query 5: Update gate availability if flight left the gate 
"Update on gate g  (cost=576.61..1293.45 rows=0 width=0) (actual time=108.463..108.468 rows=0 loops=1)"
"  ->  Hash Join  (cost=576.61..1293.45 rows=2758 width=16) (actual time=23.800..65.860 rows=2758 loops=1)"
"        Hash Cond: (f.departure_gate_id = g.gate_id)"
"        ->  Seq Scan on flight f  (cost=0.00..709.60 rows=2758 width=10) (actual time=1.372..39.807 rows=2758 loops=1)"
"              Filter: (flight_status = 'Departed'::flight_status)"
"              Rows Removed by Filter: 19930"
"        ->  Hash  (cost=345.16..345.16 rows=18516 width=10) (actual time=21.806..21.809 rows=18516 loops=1)"
"              Buckets: 32768  Batches: 1  Memory Usage: 1052kB"
"              ->  Seq Scan on gate g  (cost=0.00..345.16 rows=18516 width=10) (actual time=0.139..12.710 rows=18516 loops=1)"
"Planning Time: 11.906 ms"
"Execution Time: 109.963 ms"


Query 6: Update all flights whose aircraft status was Boarding to flight status Gate Closed
"Update on flight f  (cost=401.51..1459.91 rows=0 width=0) (actual time=145.571..145.572 rows=0 loops=1)"
"  ->  Hash Join  (cost=401.51..1459.91 rows=1062 width=16) (actual time=15.229..24.146 rows=1040 loops=1)"
"        Hash Cond: (f.aircraft_id = a.aircraft_id)"
"        ->  Seq Scan on flight f  (cost=0.00..1042.00 rows=6245 width=10) (actual time=0.014..6.509 rows=6207 loops=1)"
"              Filter: (flight_status = 'Boarding'::flight_status)"
"              Rows Removed by Filter: 43793"
"        ->  Hash  (cost=359.00..359.00 rows=3401 width=10) (actual time=15.195..15.195 rows=3401 loops=1)"
"              Buckets: 4096  Batches: 1  Memory Usage: 179kB"
"              ->  Seq Scan on aircraft a  (cost=0.00..359.00 rows=3401 width=10) (actual time=0.497..14.535 rows=3401 loops=1)"
"                    Filter: (current_status = 'Boarding'::aircraft_status)"
"                    Rows Removed by Filter: 16599"
"Planning Time: 7.628 ms"
"Execution Time: 146.417 ms"
